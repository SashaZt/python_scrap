import csvimport jsonimport osfrom datetime import datetimeimport requestsdef get_wallet():    name_files = 'wallet_balanse.csv'    with open(name_files, newline='', encoding='utf-8') as files:        reader = csv.reader(files, delimiter=',', quotechar='|')        for w in reader:            if len(w) == 1:  # Убедимся, что в строке два элемента                yield w[0]  # Используем yield для генерации кошелька и датыdef get_token():    with open('token.txt', 'r') as file:        first_value = file.readline().strip()        return first_valuedef get_total_balanse():    # Определите текущую директорию, где находится скрипт    current_directory = os.getcwd()    # Задайте имя папки data_json    data_json_directory = 'data_json'    # Создайте полный путь к папке data_json    data_json_path = os.path.join(current_directory, data_json_directory)    # Проверьте, существует ли папка data_json, и если нет, создайте ее    if not os.path.exists(data_json_path):        os.makedirs(data_json_path)    for wallet in get_wallet():  # Итерируемся по всем кошелькам и датам        token = get_token()        headers = {            'accept': 'application/json',            'AccessKey': token,        }        params = {            'id': wallet,        }        response = requests.get('https://pro-openapi.debank.com/v1/user/total_balance', params=params, headers=headers)        # headers = {        #     'accept': 'application/json',        #     'AccessKey': token,        # }        #        # params = {        #     'id': wallet,        #     'chain_id': 'eth',        #     'is_all': 'false',        # }        #        # response = requests.get('https://pro-openapi.debank.com/v1/user/token_list', params=params, headers=headers)        json_data = response.json()        chain_list_all = []        total_balance = json_data['total_usd_value']        chain_list = json_data['chain_list']        now = datetime.now()        for c in chain_list:            formatted_date = now.strftime("%d-%m-%Y")            chain_id = c['id']            chain_name = c['name']            chain_usd_value = c['usd_value']            if chain_usd_value > 0:                chain_list_all.append(                    [formatted_date, chain_name, chain_id, chain_usd_value])  # Добавляем пару как список        # Запись в CSV        with open('chain_list_all.csv', 'w', newline='', encoding='utf-8') as f:            writer = csv.writer(f)            for row in chain_list_all:                writer.writerow(row)def par_json():    with open(            'C:\\scrap_tutorial-master\\debank_com\\balanse\\data_json\\0x0c90847dc72840225ddbc6f7a76a53b96880fb37.json',            'r',            encoding="utf-8") as f:        data_json = json.load(f)    chain_list_all = []    now = datetime.now()    formatted_date = now.strftime("%d-%m-%Y")    id_chain = data_json[0]['id']    chain = data_json[0]['chain']    name_chain = data_json[0]['name']    symbol_chain = data_json[0]['symbol']    price_chain = data_json[0]['price']    amount_chain = data_json[0]['amount']    chain_list_all.append([formatted_date, id_chain, chain, name_chain, symbol_chain, price_chain,                           amount_chain])  # Добавляем пару как список    # print(id_chain,chain,name_chain,symbol_chain,price_chain,amount_chain)    # Запись в CSV    with open('token_list.csv', 'w', newline='', encoding='utf-8') as f:        writer = csv.writer(f)        for row in chain_list_all:            writer.writerow(row)    #    # chain_list_all = []    # total_balance = data_json['total_usd_value']    # # chain_list_all.append([total_balance])  # Сделаем total_balance списком с одним элементом    # chain_list = data_json['chain_list']    #    # # Форматирование даты в формате ДД-ММ-ГГГГ    #    # for c in chain_list:    #     formatted_date = now.strftime("%d-%m-%Y")    #     chain_id = c['id']    #     chain_name = c['name']    #     chain_usd_value = c['usd_value']    #     if chain_usd_value > 0:    #         chain_list_all.append([formatted_date, chain_name, chain_id, chain_usd_value])  # Добавляем пару как список    #    # # Запись в CSV    # with open('chain_list_all.csv', 'w', newline='', encoding='utf-8') as f:    #     writer = csv.writer(f)    #     for row in chain_list_all:    #         writer.writerow(row)def get_chain():    name_files = 'chain_list_all.csv'    with open(name_files, newline='', encoding='utf-8') as files:        reader = csv.reader(files, delimiter=',', quotechar='|')        for w in reader:            yield w[0], w[2]def get_token_list():    now = datetime.now()    formatted_date = now.strftime("%d-%m-%Y")    all_current_chains = []    for date, chain in get_chain():  # Итерируемся по всем кошелькам и датам        if formatted_date == date:            all_current_chains.append(chain)    for ch in all_current_chains:        # Определите текущую директорию, где находится скрипт        current_directory = os.getcwd()        # Задайте имя папки data_json        data_json_directory = 'data_json'        # Создайте полный путь к папке data_json        data_json_path = os.path.join(current_directory, data_json_directory)        # Проверьте, существует ли папка data_json, и если нет, создайте ее        if not os.path.exists(data_json_path):            os.makedirs(data_json_path)        chain_list_all = []        for wallet in get_wallet():  # Итерируемся по всем кошелькам и датам            token = get_token()            headers = {                'accept': 'application/json',                'AccessKey': token,            }            params = {                'id': wallet,                'chain_id': ch,                'is_all': 'false',            }            response = requests.get('https://pro-openapi.debank.com/v1/user/token_list', params=params, headers=headers)            json_data = response.json()            with open(f'{ch}.json', 'w', encoding='utf-8') as f:                json.dump(json_data, f, ensure_ascii=False, indent=4)  # Записываем в файл            # now = datetime.now()            # formatted_date = now.strftime("%d-%m-%Y")            # id_chain = json_data[0]['id']            # chain_chain = json_data[0]['chain']            # name_chain = json_data[0]['name']            # symbol_chain = json_data[0]['symbol']            # price_chain = json_data[0]['price']            # amount_chain = json_data[0]['amount']            # chain_list_all.append([formatted_date, id_chain, chain_chain, name_chain, symbol_chain, price_chain,            #                        amount_chain])  # Добавляем пару как список            # # print(id_chain,chain,name_chain,symbol_chain,price_chain,amount_chain)            # # Запись в CSV            # with open('token_list.csv', 'a', newline='', encoding='utf-8') as f:            #     writer = csv.writer(f)            #     for row in chain_list_all:            #         writer.writerow(row)if __name__ == '__main__':    # get_total_balanse()    # par_json()    get_token_list()