import csv
import random

import aiohttp
import asyncio

datas = []


async def get_page(session, url):
    proxy_list = [
        '94.231.216.106:8080', '149.57.12.192:8080', '5.183.253.65:8080', '185.94.32.52:8080', '83.171.254.133:8080',
        '193.233.140.54:8080', '149.57.15.166:8080', '45.145.129.76:8080', '37.44.255.63:8080', '45.67.213.41:8080',
        '193.56.64.133:8080', '149.18.57.214:8080', '193.233.230.222:8080', '213.166.79.191:8080', '45.67.212.124:8080',
        '83.171.225.57:8080', '45.132.185.36:8080', '194.104.9.200:8080', '83.171.255.63:8080', '213.166.77.160:8080',
        '37.44.254.208:8080', '185.94.32.191:8080', '185.88.101.25:8080', '45.67.213.66:8080', '185.88.101.124:8080',
        '185.77.221.217:8080', '85.209.151.197:8080', '85.209.151.158:8080', '91.242.228.100:8080',
        '213.166.79.197:8080', '95.181.150.219:8080', '176.126.111.96:8080', '149.18.31.60:8080',
        '193.233.228.173:8080', '213.166.76.101:8080', '91.242.228.32:8080', '185.94.33.102:8080',
        '91.242.228.114:8080', '45.67.212.143:8080', '149.18.58.131:8080', '193.56.64.39:8080', '185.77.221.152:8080',
        '149.18.28.42:8080', '213.166.76.84:8080', '193.233.137.237:8080', '185.77.220.99:8080', '85.208.87.36:8080',
        '37.44.254.185:8080', '213.166.79.47:8080', '185.88.37.106:8080', '88.218.46.107:8080', '45.67.212.101:8080',
        '93.177.117.23:8080', '149.18.30.139:8080', '149.18.31.140:8080', '149.18.31.154:8080', '185.77.220.78:8080',
        '93.177.117.175:8080', '185.94.34.184:8080', '149.57.14.207:8080', '89.191.228.138:8080',
        '193.233.230.187:8080', '45.67.212.20:8080', '149.18.30.17:8080', '83.171.254.178:8080', '93.177.117.239:8080',
        '212.119.40.154:8080', '37.44.254.115:8080', '83.171.225.183:8080', '185.77.223.25:8080', '213.166.79.96:8080',
        '149.57.15.189:8080', '83.171.255.188:8080', '185.94.34.25:8080', '62.204.35.94:8080', '141.98.85.250:8080',
        '95.181.148.187:8080', '45.145.128.60:8080', '83.171.255.186:8080', '185.88.101.153:8080',
        '95.181.151.165:8080', '149.18.57.157:8080', '213.108.1.246:8080', '83.171.255.226:8080', '37.44.254.243:8080',
        '85.209.149.41:8080', '45.66.209.31:8080', '45.67.212.248:8080', '83.171.254.21:8080', '45.148.125.181:8080',
        '193.233.140.222:8080', '45.10.165.94:8080', '193.233.140.218:8080', '95.181.151.160:8080',
        '91.188.247.24:8080', '45.145.131.223:8080', '185.88.101.45:8080', '193.233.138.200:8080', '89.19.34.186:8080',
        '91.188.246.200:8080', '83.171.225.193:8080', '185.88.101.130:8080', '212.119.41.174:8080',
        '83.171.254.239:8080', '149.18.29.132:8080', '85.208.209.240:8080', '193.233.229.112:8080',
        '193.31.127.245:8080', '85.239.59.167:8080', '95.181.150.73:8080', '5.183.253.222:8080', '213.108.1.107:8080',
        '83.171.254.34:8080', '85.208.209.155:8080', '213.166.77.190:8080', '193.202.16.106:8080', '88.218.65.238:8080',
        '45.67.212.215:8080', '185.88.101.145:8080', '45.159.23.94:8080', '212.119.41.73:8080', '193.233.82.190:8080',
        '88.218.46.84:8080', '193.233.228.146:8080', '149.57.14.172:8080', '149.57.13.94:8080', '88.218.46.188:8080',
        '85.208.209.63:8080', '193.233.230.119:8080', '85.209.150.160:8080', '213.166.78.27:8080', '45.80.107.142:8080',
        '85.209.149.76:8080', '149.18.31.253:8080', '93.177.117.195:8080', '95.181.149.112:8080', '95.181.150.174:8080',
        '93.177.117.243:8080', '193.233.229.93:8080', '149.57.15.18:8080', '95.181.150.68:8080', '149.18.28.95:8080',
        '193.233.228.150:8080', '85.239.56.198:8080', '85.208.210.100:8080', '212.119.40.35:8080', '193.56.20.53:8080',
        '95.181.150.126:8080', '149.18.57.235:8080', '193.233.140.65:8080', '193.233.211.154:8080',
        '89.191.228.252:8080', '213.108.1.104:8080', '178.159.107.114:8080', '149.57.13.164:8080', '193.233.83.28:8080',
        '89.191.229.57:8080', '178.20.212.245:8080', '149.18.59.162:8080', '83.171.254.246:8080', '213.166.76.229:8080',
        '88.218.66.153:8080', '45.145.131.188:8080', '193.233.141.249:8080', '149.57.12.208:8080', '62.204.35.122:8080',
        '193.233.228.102:8080', '94.231.216.192:8080', '193.233.141.30:8080', '193.233.83.186:8080',
        '85.208.85.206:8080', '45.145.129.110:8080', '89.191.228.17:8080', '193.56.64.78:8080', '193.233.138.75:8080',
        '85.239.59.59:8080', '185.94.35.99:8080', '149.18.58.95:8080', '85.209.150.135:8080', '93.177.116.102:8080',
        '213.166.79.165:8080', '185.88.101.85:8080', '149.18.58.169:8080', '85.208.211.77:8080', '45.80.106.78:8080',
        '149.57.12.250:8080', '178.20.212.152:8080', '85.208.209.124:8080', '193.56.64.15:8080', '89.191.229.13:8080',
        '149.18.30.91:8080', '45.132.185.82:8080', '185.77.223.215:8080', '45.145.131.214:8080', '85.208.87.41:8080',
        '45.67.213.45:8080', '45.159.23.133:8080', '45.159.23.176:8080', '178.20.212.132:8080', '91.188.246.103:8080',
        '193.56.20.54:8080', '193.233.229.224:8080', '194.99.25.183:8080', '193.56.64.40:8080', '193.56.72.125:8080',
        '176.126.111.105:8080', '85.239.59.237:8080', '88.218.67.52:8080', '185.94.34.195:8080', '193.31.127.57:8080',
        '149.18.29.217:8080', '194.110.150.28:8080', '185.88.37.181:8080', '213.166.77.24:8080', '193.233.82.198:8080',
        '149.18.28.225:8080', '94.154.127.117:8080', '141.98.85.45:8080', '93.177.117.176:8080', '45.145.131.36:8080',
        '193.31.127.217:8080', '91.242.228.247:8080', '85.208.87.48:8080', '149.57.15.159:8080', '45.148.125.152:8080',
        '85.208.209.171:8080', '149.18.56.216:8080', '193.202.16.69:8080', '45.138.101.212:8080', '141.98.85.11:8080',
        '83.171.255.140:8080', '85.208.211.251:8080', '185.77.221.155:8080', '85.209.149.218:8080',
        '149.18.28.233:8080', '194.110.150.82:8080', '45.138.101.96:8080', '193.202.16.209:8080', '193.233.142.64:8080',
        '149.18.57.136:8080', '149.18.31.139:8080', '45.67.213.246:8080', '45.132.185.104:8080', '94.154.127.32:8080',
        '88.218.65.115:8080', '45.80.107.191:8080', '88.218.46.238:8080', '193.56.20.28:8080', '178.20.212.43:8080',
        '94.231.216.198:8080', '45.145.131.117:8080', '193.233.230.30:8080', '83.171.255.40:8080',
        '193.233.229.202:8080', '193.56.72.43:8080', '45.80.106.53:8080', '94.154.127.161:8080', '193.233.82.118:8080',
        '193.233.83.111:8080', '45.66.209.36:8080', '193.233.142.99:8080', '149.57.12.145:8080', '149.18.30.219:8080',
        '95.181.151.250:8080', '85.209.151.23:8080', '146.185.204.82:8080', '45.145.131.221:8080', '94.154.127.75:8080',
        '149.18.30.244:8080', '62.204.35.97:8080', '93.177.116.99:8080', '185.88.101.63:8080', '194.110.150.13:8080',
        '193.233.143.198:8080', '45.10.165.172:8080', '83.171.255.49:8080', '88.218.46.135:8080', '83.171.255.41:8080',
        '85.209.150.15:8080', '193.202.16.166:8080', '85.239.57.142:8080', '176.126.111.79:8080', '141.98.85.128:8080',
        '45.80.107.148:8080', '62.204.35.218:8080', '88.218.46.24:8080', '185.88.101.166:8080', '45.66.209.48:8080',
        '91.188.247.51:8080', '83.171.225.87:8080', '94.154.127.47:8080', '85.208.210.190:8080', '149.18.31.121:8080',
        '83.171.225.96:8080', '193.233.142.78:8080', '83.171.255.224:8080', '88.218.66.99:8080', '149.57.13.243:8080',
        '91.188.247.59:8080', '95.181.148.251:8080', '185.94.34.227:8080', '193.56.64.85:8080', '83.171.255.237:8080',
        '193.31.127.196:8080', '88.218.66.57:8080', '85.239.57.39:8080', '149.18.31.20:8080', '91.188.247.66:8080',
        '185.77.223.57:8080', '212.119.41.191:8080', '85.208.85.159:8080', '85.208.209.83:8080', '45.67.212.146:8080',
        '88.218.66.78:8080', '89.191.229.125:8080', '212.119.41.78:8080', '193.56.64.195:8080', '149.18.57.156:8080',
        '185.77.223.127:8080', '149.18.30.242:8080', '193.233.140.201:8080', '95.181.149.198:8080',
        '178.159.107.55:8080', '193.233.141.78:8080', '149.57.15.100:8080', '45.67.212.217:8080', '85.208.210.41:8080',
        '95.181.151.14:8080', '93.177.116.211:8080', '85.208.211.232:8080', '213.166.79.181:8080',
        '193.233.228.140:8080', '178.159.107.59:8080', '95.181.151.225:8080', '85.239.58.173:8080',
        '185.88.101.66:8080', '185.94.33.196:8080', '89.191.228.74:8080', '45.67.213.135:8080', '185.88.101.167:8080',
        '94.154.127.112:8080', '85.208.211.43:8080', '213.166.77.253:8080', '185.77.220.30:8080', '193.233.82.180:8080',
        '5.183.253.168:8080', '176.126.111.232:8080', '149.57.12.54:8080', '85.209.150.24:8080', '95.181.149.166:8080',
        '193.202.16.160:8080', '85.239.58.95:8080', '194.104.9.212:8080', '95.181.151.247:8080', '83.171.255.120:8080',
        '212.119.41.182:8080', '193.233.137.96:8080', '91.188.246.72:8080', '93.177.117.177:8080',
        '45.148.125.218:8080', '37.44.255.112:8080', '185.77.223.182:8080', '45.159.23.167:8080', '185.94.32.29:8080',
        '212.119.40.204:8080', '185.77.220.73:8080', '85.208.211.188:8080', '193.233.230.163:8080',
        '45.145.131.70:8080', '91.242.228.232:8080', '85.239.59.40:8080', '193.233.138.134:8080', '193.56.20.171:8080',
        '85.239.57.205:8080', '149.18.57.49:8080', '213.108.1.159:8080', '85.239.58.196:8080', '193.233.143.143:8080',
        '149.18.31.17:8080', '89.191.229.90:8080', '185.94.33.79:8080', '193.56.20.198:8080', '85.209.151.111:8080',
        '62.204.35.201:8080', '149.18.59.105:8080', '193.233.137.220:8080', '141.98.85.117:8080',
        '193.233.229.150:8080', '95.181.148.196:8080', '185.88.101.197:8080', '91.242.228.194:8080',
        '185.77.221.181:8080', '185.77.221.47:8080', '176.126.111.202:8080', '85.208.87.119:8080', '95.181.149.29:8080',
        '85.208.85.250:8080', '89.191.229.49:8080', '193.233.82.108:8080', '88.218.46.206:8080', '91.242.228.224:8080',
        '178.159.107.163:8080', '193.233.83.21:8080', '85.239.56.246:8080', '193.56.64.237:8080', '45.138.101.208:8080',
        '149.57.14.233:8080', '45.145.128.241:8080', '149.18.56.246:8080', '193.233.137.211:8080',
        '185.77.221.212:8080', '94.231.216.116:8080', '212.119.41.208:8080', '149.18.57.55:8080', '149.18.59.213:8080',
        '193.31.127.11:8080', '193.233.138.227:8080', '193.233.141.215:8080', '194.110.150.38:8080',
        '149.18.57.43:8080', '45.145.129.188:8080', '85.239.57.236:8080', '83.171.225.74:8080', '193.233.141.228:8080',
        '45.66.209.15:8080', '185.94.34.233:8080', '176.126.111.56:8080', '193.233.210.85:8080', '85.208.87.166:8080',
        '85.239.58.23:8080', '89.19.34.238:8080', '88.218.46.166:8080', '37.44.254.14:8080', '212.119.40.216:8080',
        '85.209.151.146:8080', '85.208.86.208:8080', '185.77.223.83:8080', '185.77.223.75:8080', '85.239.56.251:8080',
        '141.98.85.118:8080', '193.56.20.73:8080', '85.208.86.135:8080', '213.166.78.60:8080', '85.208.209.122:8080',
        '89.191.228.100:8080', '149.18.28.127:8080', '213.166.77.84:8080', '149.57.12.223:8080', '45.138.101.156:8080',
        '193.233.140.141:8080', '193.233.142.166:8080', '85.208.210.196:8080', '185.94.35.217:8080',
        '176.126.111.49:8080', '83.171.254.42:8080', '91.188.247.237:8080', '185.77.220.221:8080',
        '193.233.230.106:8080', '45.80.106.61:8080', '95.181.149.100:8080', '5.183.253.130:8080', '89.19.34.158:8080',
        '85.208.85.238:8080', '194.104.9.118:8080', '45.66.209.81:8080', '178.159.107.122:8080', '193.233.211.234:8080',
        '185.88.101.172:8080', '45.138.101.184:8080', '193.233.229.131:8080', '89.19.34.100:8080', '89.19.34.163:8080',
        '45.10.165.202:8080', '193.233.143.90:8080', '45.159.23.48:8080', '185.94.32.131:8080', '45.80.106.122:8080',
        '85.208.85.149:8080', '95.181.150.18:8080', '193.233.83.19:8080', '185.94.35.100:8080', '149.57.12.71:8080',
        '146.185.204.41:8080', '193.233.228.227:8080', '62.204.35.178:8080', '193.233.231.176:8080',
        '185.88.101.106:8080', '85.208.211.155:8080', '149.18.28.174:8080', '193.233.231.172:8080',
        '213.166.77.27:8080', '93.177.117.116:8080', '193.233.230.219:8080', '95.181.148.105:8080',
        '91.188.247.12:8080', '85.208.86.141:8080', '88.218.46.64:8080', '213.166.76.220:8080', '149.18.28.229:8080',
        '95.181.149.11:8080', '149.18.57.228:8080', '88.218.66.90:8080', '91.188.247.69:8080', '45.145.129.215:8080',
        '146.185.204.63:8080', '45.138.101.100:8080', '45.67.212.67:8080', '176.126.111.237:8080',
        '185.77.223.237:8080', '85.208.87.93:8080', '85.208.86.161:8080', '149.57.14.129:8080', '149.18.57.83:8080',
        '85.208.85.186:8080', '93.177.117.179:8080', '85.209.150.248:8080', '212.119.41.53:8080', '45.132.185.81:8080',
        '83.171.255.97:8080', '88.218.66.203:8080', '193.233.140.230:8080', '193.233.228.71:8080',
        '193.233.230.227:8080', '212.119.41.101:8080', '85.209.149.173:8080', '85.209.150.235:8080',
        '193.31.127.243:8080', '45.159.23.118:8080', '193.56.72.38:8080', '213.108.1.249:8080', '193.233.231.254:8080',
        '45.148.125.56:8080', '213.108.1.112:8080', '193.233.137.12:8080', '85.208.86.148:8080', '149.57.15.112:8080',
        '149.18.29.86:8080', '85.208.87.115:8080', '213.166.76.192:8080', '45.159.23.126:8080', '193.233.141.210:8080',
        '95.181.151.252:8080', '85.208.210.186:8080', '89.19.34.237:8080', '89.191.228.81:8080', '193.56.72.234:8080',
        '185.94.35.208:8080', '194.99.25.175:8080', '85.239.59.23:8080', '194.104.9.51:8080', '5.183.253.240:8080',
        '45.148.125.83:8080', '193.233.143.154:8080', '85.208.86.233:8080', '178.20.212.162:8080', '45.67.212.153:8080',
        '91.188.246.162:8080', '149.18.58.245:8080', '193.56.64.96:8080', '45.66.209.115:8080', '91.242.228.185:8080',
        '89.19.34.122:8080', '193.31.127.218:8080', '88.218.67.240:8080', '45.145.131.219:8080', '194.99.25.233:8080',
        '95.181.149.25:8080', '212.119.41.44:8080', '185.88.101.19:8080', '193.233.83.32:8080', '194.110.150.63:8080',
        '95.181.150.215:8080', '193.56.20.159:8080', '149.18.57.108:8080', '83.171.225.83:8080', '193.233.228.164:8080',
        '213.108.1.29:8080', '193.31.127.162:8080', '149.18.58.112:8080', '88.218.46.201:8080', '193.233.83.220:8080',
        '213.166.76.178:8080', '45.148.125.172:8080', '193.233.140.223:8080', '85.239.59.127:8080', '149.18.56.66:8080',
        '85.239.56.229:8080', '45.145.131.101:8080', '85.209.149.75:8080', '193.233.142.98:8080', '185.94.35.97:8080',
        '185.77.221.222:8080', '37.44.254.249:8080', '85.239.59.123:8080', '185.94.33.40:8080', '193.56.20.55:8080',
        '45.66.209.191:8080', '91.188.247.148:8080', '193.233.142.121:8080', '45.80.106.57:8080', '85.239.57.49:8080',
        '37.44.255.224:8080', '45.138.101.221:8080', '85.208.87.84:8080', '149.57.14.60:8080', '85.209.151.203:8080',
        '89.191.228.29:8080', '149.18.29.117:8080', '45.80.106.64:8080', '85.239.58.19:8080', '89.191.229.165:8080',
        '62.204.35.166:8080', '85.209.150.111:8080', '85.239.58.198:8080', '149.18.30.195:8080', '93.177.117.40:8080',
        '88.218.46.11:8080', '149.18.59.186:8080', '45.67.213.78:8080', '149.57.15.26:8080', '149.57.12.178:8080',
        '45.159.23.71:8080', '45.138.101.33:8080', '185.77.221.110:8080', '37.44.255.105:8080', '85.208.87.56:8080',
        '85.208.210.151:8080', '185.94.33.166:8080', '85.239.56.217:8080', '85.208.87.42:8080', '45.145.128.143:8080',
        '149.18.29.205:8080', '185.94.35.31:8080', '45.66.209.146:8080', '83.171.255.42:8080', '185.94.34.108:8080',
        '194.99.25.193:8080', '89.191.228.242:8080', '193.233.83.129:8080', '37.44.254.76:8080', '95.181.150.133:8080',
        '83.171.225.154:8080', '193.233.137.161:8080', '85.208.210.42:8080', '141.98.85.196:8080', '213.108.1.15:8080',
        '45.132.185.236:8080', '45.80.107.195:8080', '149.57.13.186:8080', '193.233.228.22:8080', '85.208.87.18:8080',
        '45.80.107.169:8080', '45.80.107.52:8080', '45.148.125.179:8080', '185.94.32.94:8080', '193.233.82.11:8080',
        '193.233.83.96:8080', '94.231.216.46:8080', '37.44.254.167:8080', '45.145.129.228:8080', '83.171.255.190:8080',
        '149.18.58.108:8080', '193.56.64.123:8080', '45.66.209.208:8080', '213.166.76.82:8080', '93.177.117.155:8080',
        '213.166.78.114:8080', '45.159.23.237:8080', '91.188.246.75:8080', '95.181.151.81:8080', '85.208.209.12:8080',
        '45.145.131.78:8080', '85.208.209.163:8080', '85.208.86.223:8080', '45.80.107.205:8080', '149.18.56.48:8080',
        '213.166.77.159:8080', '83.171.225.179:8080', '149.57.12.142:8080', '93.177.117.170:8080',
        '178.159.107.250:8080', '185.77.220.61:8080', '85.209.151.175:8080', '95.181.151.135:8080',
        '185.77.221.74:8080', '89.191.229.194:8080', '213.166.78.214:8080', '45.80.107.211:8080', '88.218.46.22:8080',
        '185.88.101.27:8080', '45.80.107.249:8080', '185.77.221.240:8080', '149.18.57.31:8080', '85.209.150.144:8080',
        '91.188.247.228:8080', '193.233.228.152:8080', '88.218.65.80:8080', '178.159.107.166:8080',
        '193.233.230.192:8080', '45.145.131.149:8080', '83.171.255.207:8080', '185.88.101.61:8080', '85.239.58.20:8080',
        '149.57.14.81:8080', '89.19.34.134:8080', '185.88.37.40:8080', '85.239.56.104:8080', '149.18.57.28:8080',
        '213.166.76.49:8080', '85.239.58.52:8080', '95.181.151.76:8080', '83.171.254.78:8080', '45.159.23.250:8080',
        '176.126.111.212:8080', '85.239.57.121:8080', '193.233.140.72:8080', '85.208.211.231:8080',
        '5.183.253.247:8080', '185.77.220.93:8080', '83.171.254.243:8080', '45.80.107.212:8080', '62.204.35.124:8080',
        '149.18.29.123:8080', '141.98.85.249:8080', '193.233.141.114:8080', '176.126.111.86:8080', '45.145.129.91:8080',
        '193.233.228.224:8080', '91.188.247.56:8080', '45.67.212.29:8080', '5.183.253.27:8080', '85.239.56.170:8080',
        '185.77.220.75:8080', '85.239.59.60:8080', '193.233.140.26:8080', '85.208.85.31:8080', '149.18.58.94:8080',
        '212.119.40.231:8080', '37.44.254.205:8080', '85.239.59.148:8080', '45.148.125.174:8080', '45.10.165.150:8080',
        '149.57.13.85:8080', '213.166.78.91:8080', '193.233.210.216:8080', '149.18.56.97:8080', '89.191.229.112:8080',
        '193.56.20.36:8080', '85.239.57.194:8080', '45.148.125.27:8080', '91.188.246.155:8080', '94.154.127.200:8080',
        '45.10.165.128:8080', '85.239.57.140:8080', '45.145.131.163:8080', '193.233.229.58:8080', '213.108.1.19:8080',
        '149.18.28.55:8080', '83.171.255.73:8080', '85.239.56.148:8080', '194.110.150.86:8080', '193.233.143.67:8080',
        '85.209.150.51:8080', '185.94.33.84:8080', '185.94.32.108:8080', '149.57.15.196:8080', '178.20.212.78:8080',
        '37.44.254.218:8080', '149.18.56.189:8080', '213.166.76.102:8080', '212.119.41.179:8080', '149.18.29.203:8080',
        '95.181.150.29:8080', '193.56.64.190:8080', '193.202.16.91:8080', '141.98.85.157:8080', '85.208.211.52:8080',
        '212.119.40.126:8080', '85.239.58.18:8080', '213.166.78.241:8080', '85.239.56.105:8080', '37.44.254.155:8080',
        '85.239.57.234:8080', '194.99.25.205:8080', '178.20.212.107:8080', '185.94.34.105:8080', '89.19.34.183:8080',
        '178.20.212.177:8080', '185.77.220.145:8080', '193.233.137.89:8080', '141.98.85.186:8080', '213.166.77.46:8080',
        '94.154.127.188:8080', '185.77.220.170:8080', '85.208.210.104:8080', '185.88.37.121:8080',
        '85.208.209.133:8080', '212.119.41.112:8080', '88.218.65.33:8080', '149.18.58.105:8080', '193.233.140.104:8080',
        '185.94.35.117:8080', '149.18.29.235:8080', '85.209.149.187:8080', '85.209.150.62:8080', '185.88.101.168:8080',
        '194.104.9.142:8080', '194.104.9.229:8080', '85.209.149.69:8080', '85.208.209.43:8080', '88.218.67.171:8080',
        '193.233.143.157:8080', '83.171.254.192:8080', '213.166.78.171:8080', '185.77.221.200:8080',
        '95.181.149.184:8080', '45.138.101.234:8080', '37.44.254.157:8080', '149.57.12.12:8080', '193.233.140.117:8080',
        '212.119.41.242:8080', '45.67.212.35:8080', '93.177.116.128:8080', '91.242.228.229:8080', '193.233.228.89:8080',
        '193.233.230.172:8080', '37.44.254.253:8080', '178.159.107.141:8080', '85.208.211.239:8080',
        '83.171.225.82:8080', '185.88.37.173:8080', '212.119.40.226:8080', '85.208.209.202:8080',
        '193.233.137.155:8080', '88.218.46.96:8080', '88.218.66.240:8080', '185.77.223.224:8080', '213.166.76.123:8080',
        '45.159.23.242:8080', '213.166.77.34:8080', '193.233.83.104:8080', '88.218.66.248:8080', '193.56.64.59:8080',
        '149.18.28.131:8080', '212.119.41.30:8080', '193.56.64.154:8080', '45.67.213.208:8080', '193.233.231.126:8080',
        '85.239.58.30:8080', '149.18.56.80:8080', '185.94.32.185:8080', '45.80.107.44:8080', '193.56.64.81:8080',
        '149.18.56.136:8080', '193.233.142.31:8080', '213.166.76.230:8080', '178.20.212.178:8080',
        '45.132.185.174:8080', '193.233.229.67:8080', '83.171.254.27:8080', '45.66.209.129:8080', '94.154.127.189:8080',
        '149.18.29.219:8080', '85.208.211.75:8080', '85.208.211.158:8080', '88.218.66.55:8080', '193.56.20.122:8080',
        '193.233.230.56:8080', '193.233.229.43:8080', '194.110.150.193:8080', '149.57.14.238:8080',
        '149.57.13.122:8080', '85.239.59.242:8080', '83.171.254.59:8080', '194.99.25.77:8080', '185.94.32.59:8080',
        '149.18.59.93:8080', '149.18.29.82:8080', '193.233.137.26:8080', '85.209.150.228:8080', '83.171.225.40:8080',
        '193.233.210.16:8080', '213.166.77.145:8080', '95.181.151.97:8080', '85.209.150.81:8080', '85.208.210.134:8080',
        '45.67.213.103:8080', '176.126.111.20:8080', '93.177.117.191:8080', '149.18.59.199:8080', '149.18.31.118:8080',
        '85.209.151.83:8080', '149.18.56.52:8080', '45.145.131.153:8080', '185.88.37.20:8080', '89.191.228.95:8080',
        '193.233.83.240:8080', '194.110.150.173:8080', '149.18.57.35:8080', '149.18.30.97:8080', '37.44.255.42:8080',
        '193.233.83.222:8080', '37.44.254.252:8080', '89.191.229.210:8080', '95.181.149.96:8080', '193.56.64.41:8080',
        '193.233.138.40:8080', '88.218.46.12:8080', '213.166.78.125:8080', '89.191.229.41:8080', '193.233.142.71:8080',
        '85.208.86.133:8080', '85.209.150.207:8080', '193.233.210.82:8080', '89.191.228.137:8080',
        '45.138.101.107:8080', '45.148.125.251:8080', '185.94.34.45:8080', '193.56.20.157:8080', '85.239.56.103:8080',
        '149.18.57.53:8080', '213.166.77.199:8080', '185.94.35.149:8080', '149.57.13.213:8080', '95.181.149.230:8080',
        '149.57.12.100:8080', '91.188.247.50:8080', '194.99.25.163:8080', '85.239.59.254:8080', '149.18.58.213:8080',
        '149.57.14.146:8080', '193.56.20.223:8080', '62.204.35.191:8080', '45.67.213.119:8080', '85.209.149.74:8080',
        '85.209.150.239:8080', '193.56.20.78:8080', '37.44.255.19:8080', '141.98.85.232:8080', '94.231.216.152:8080',
        '94.231.216.72:8080', '45.138.101.207:8080', '185.88.101.199:8080', '88.218.65.246:8080', '5.183.253.66:8080',
        '83.171.255.122:8080', '93.177.117.112:8080', '178.159.107.22:8080', '178.20.212.99:8080', '95.181.150.79:8080',
        '149.18.56.253:8080', '185.77.220.190:8080', '93.177.116.150:8080', '193.233.210.102:8080',
        '45.80.107.157:8080', '45.80.107.70:8080', '95.181.150.157:8080', '213.166.77.44:8080', '146.185.204.17:8080',
        '213.166.79.180:8080', '213.166.78.156:8080', '149.18.29.41:8080', '88.218.67.31:8080', '85.209.150.174:8080',
        '193.233.143.120:8080', '193.233.229.252:8080', '85.209.151.125:8080', '45.10.165.160:8080',
        '85.208.87.223:8080', '85.208.211.21:8080', '185.94.35.206:8080', '85.208.87.43:8080', '88.218.46.138:8080',
        '83.171.254.64:8080', '141.98.85.146:8080', '185.77.223.150:8080', '149.57.13.181:8080', '141.98.85.167:8080',
        '193.233.230.203:8080', '193.233.83.81:8080', '194.99.25.209:8080', '178.159.107.34:8080', '95.181.148.68:8080',
        '194.110.150.51:8080', '85.239.56.116:8080', '88.218.46.58:8080', '45.148.125.48:8080', '149.18.28.171:8080',
        '193.233.141.96:8080', '91.188.246.82:8080', '85.239.58.203:8080', '149.57.15.97:8080', '193.233.143.175:8080',
        '193.56.64.155:8080', '213.166.77.47:8080', '85.239.56.20:8080', '213.166.78.111:8080', '45.145.128.87:8080',
        '95.181.149.111:8080', '212.119.41.144:8080'
    ]
    bad_url = []
    """Выбираем случайным образом прокси"""
    proxy = f'http://{random.choice(proxy_list)}'
    proxy_auth = aiohttp.BasicAuth('USQ5Q5FG3', 'pN5hqMms')

    header = {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36"

    }
    async with session.get(url, headers=header, proxy=proxy, proxy_auth=proxy_auth) as r:
        if r.status == 200:
            # print(proxy)
            # print(url)
            return await r.text()
        else:
            """Создается список ссылок который бел отсечен при сбои, запускаем только тогда когда прошли полностью основной список"""
            bad_url.append(url)
            with open(f"bad_url.csv", "a", newline='', errors='ignore') as file:
                writer = csv.writer(file)
                writer.writerow(
                    bad_url
                )


async def get_all(session, urls):
    tasks = []
    for url in urls:
        task = asyncio.create_task(get_page(session, url))
        tasks.append(task)
    results = await asyncio.gather(*tasks)
    await parse(results)


async def main(urls):
    async with aiohttp.ClientSession() as session:
        data = await get_all(session, urls)
        return data


async def parse(results):
    """При записи обезательно изменять счетчик"""
    counter = 1
    for i in results:
        if i != None:
            counter += 1
            with open(f"c:\\DATA_TG\\{counter}.html", "w",
                      encoding='utf-8') as file:
                file.write(i)
        else:
            continue


if __name__ == '__main__':
    urls = [

    ]
    """Вставляем список ссылок ф формате csv, лучше всего по 1000 запросов за раз отправлять"""
    with open('C:\\scrap_tutorial-master\\tgstat.ru\\url_all.csv', newline='', encoding='utf-8') as files:
        csv_reader = list(csv.reader(files, delimiter=' ', quotechar='|'))
        count_url = 0
        for row in csv_reader[:1000]:
            count_url += 1
            urls.append(row[0])

    results = asyncio.run(main(urls))
