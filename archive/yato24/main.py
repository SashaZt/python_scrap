import re
import json
import requests
from bs4 import BeautifulSoup

text = """[{"id":2020,"article":"737159561","brand_title":"Yato","title":"Профессиональный набор инструментов 216 эл. YATO YT-38841","price":4550,"url":"https:\/\/yato24.com.ua\/professionalnyy-yato-yt-38841\/","category_string":"Наборы инструментов","article_for_display":"YT-38841","in_stock":true},{"id":2018,"article":"737156658","brand_title":"Yato","title":"Набор инструмента 122 предметов YATO YT-38901","price":4700,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-yato-yt-38901-122-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-38901","in_stock":true},{"id":2279,"article":"737156379","brand_title":"Yato","title":"Профессиональный набор инструментов 108 предметов YATO YT-38791","price":3250,"url":"https:\/\/yato24.com.ua\/professionalnyy-nabor-instrumentov-yato-yt-38791-108-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-38791","in_stock":true},{"id":2016,"article":"737153686","brand_title":"Yato","title":"Профессиональный набор инструментов 94 предметов YATO YT-12681","price":3000,"url":"https:\/\/yato24.com.ua\/professionalnyy-nabor-instrumentov-yato-yt-12681-94-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-12681","in_stock":true},{"id":2015,"article":"737040071","brand_title":"Yato","title":"Набор инструментов 56 предметов YATO YT-14501","price":1200,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-yato-yt-14501-56-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-14501","in_stock":true},{"id":1762,"article":"737159736","brand_title":"Yato","title":"Набор инструментов 225 предметов YATO YT-38941","price":7000,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-225-predmetov-yato-yt-38941\/","category_string":"Наборы инструментов","article_for_display":"YT-38941","in_stock":true},{"id":2284,"article":"737158375","brand_title":"Yato","title":"Набор инструмента для авто с ключами YATO YT-38881","price":4800,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-avto-s-kluchami-yato-yt-38881\/","category_string":"Наборы инструментов","article_for_display":"YT-38881","in_stock":true},{"id":2025,"article":"737217725","brand_title":"Yato","title":"Набор инструментов электрика профессиональный YATO YT-39009","price":3700,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-elektrika-professionalnyy-yato-yt-39009\/","category_string":"Наборы инструментов","article_for_display":"YT-39009","in_stock":true},{"id":2043,"article":"737488287","brand_title":"Yato","title":"Набор инструментов в ящике с выдвижными полками YATO YT-38951","price":4950,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-v-yashchike-s-vydvizhnymi-polkami-yato-yt-38951\/","category_string":"Наборы инструментов","article_for_display":"YT-38951","in_stock":true},{"id":2275,"article":"737061696","brand_title":"Yato","title":"Набор инструментов для ремонта автомобиля YATO YT-38741","price":2190,"url":"https:\/\/yato24.com.ua\/nabor-golovok-dlya-remonta-avtomobilya-yato-yt-38741\/","category_string":"Наборы инструментов","article_for_display":"YT-38741","in_stock":true},{"id":2276,"article":"737064521","brand_title":"Yato","title":"Набор инструментов с ключами YATO YT-38781","price":3500,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-s-kluchami-yato-yt-38781\/","category_string":"Наборы инструментов","article_for_display":"YT-38781","in_stock":true},{"id":2278,"article":"737148400","brand_title":"Yato","title":"Набор инструментов с ключами 82 эл. YATO YT-12691","price":3400,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-s-kluchami-dlya-remonta-avto-yato-yt-12691\/","category_string":"Наборы инструментов","article_for_display":"YT-12691","in_stock":true},{"id":2280,"article":"737156916","brand_title":"Yato","title":"Набор инструментов для автомобиля 111 предметов YATO YT-38831","price":4400,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-dlya-avtomobilya-yato-yt-38831\/","category_string":"Наборы инструментов","article_for_display":"YT-38831","in_stock":true},{"id":2283,"article":"737158259","brand_title":"Yato","title":"Набор инструмента для ремонта авто с насадками YATO YT-38872","price":5000,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-remonta-avto-s-nasadkami-yato-yt-38872\/","category_string":"Наборы инструментов","article_for_display":"YT-38872","in_stock":true},{"id":2285,"article":"737159448","brand_title":"Yato","title":"Набор инструмента для автомобиля с насадками YATO YT-38931","price":4200,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-avtomobilya-s-nasadkami-yato-yt-38931\/","category_string":"Наборы инструментов","article_for_display":"YT-38931","in_stock":true},{"id":2022,"article":"737174994","brand_title":"Yato","title":"Набор слесарно монтажного инструмента YATO YT-39280","price":1800,"url":"https:\/\/yato24.com.ua\/nabor-slesarno-montazhnogo-instrumenta-yato-yt-39280\/","category_string":"Наборы инструментов","article_for_display":"YT-39280","in_stock":true},{"id":2019,"article":"737158962","brand_title":"Yato","title":"Набор инструмента для ремонта автомобиля YATO YT-38811","price":5700,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-remonta-avtomobilya-yato-yt-38811\/","category_string":"Наборы инструментов","article_for_display":"YT-38811","in_stock":true},{"id":1761,"article":"737035923","brand_title":"Yato","title":"Набор инструментов YATO YT-14461","price":910,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-yato-yt-14461\/","category_string":"Наборы инструментов","article_for_display":"YT-14461","in_stock":true},{"id":1810,"article":"737525497","brand_title":"Yato","title":"Диагностический набор к форсункам common rail YATO YT-7306","price":1650,"url":"https:\/\/yato24.com.ua\/diagnosticheskiy-nabor-k-forsunkam-common-rail-yato-yt-7306\/","category_string":"Наборы инструментов","article_for_display":"YT-7306","in_stock":true},{"id":1811,"article":"737530482","brand_title":"Yato","title":"Набор инструмента для ремонта автомобильных генераторов YATO YT-04211","price":1860,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-remonta-avtomobilnykh-generatorov-yato-yt-04211\/","category_string":"Наборы инструментов","article_for_display":"YT-04211","in_stock":true}]"""
script_java = """<script type="text/javascript">
(function () {})(window.dataLayer = window.dataLayer || []);
var products = [{"id":2020,"article":"737159561","brand_title":"Yato","title":"Профессиональный набор инструментов 216 эл. YATO YT-38841","price":4550,"url":"https:\/\/yato24.com.ua\/professionalnyy-yato-yt-38841\/","category_string":"Наборы инструментов","article_for_display":"YT-38841","in_stock":true},{"id":2018,"article":"737156658","brand_title":"Yato","title":"Набор инструмента 122 предметов YATO YT-38901","price":4700,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-yato-yt-38901-122-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-38901","in_stock":true},{"id":2279,"article":"737156379","brand_title":"Yato","title":"Профессиональный набор инструментов 108 предметов YATO YT-38791","price":3250,"url":"https:\/\/yato24.com.ua\/professionalnyy-nabor-instrumentov-yato-yt-38791-108-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-38791","in_stock":true},{"id":2016,"article":"737153686","brand_title":"Yato","title":"Профессиональный набор инструментов 94 предметов YATO YT-12681","price":3000,"url":"https:\/\/yato24.com.ua\/professionalnyy-nabor-instrumentov-yato-yt-12681-94-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-12681","in_stock":true},{"id":2015,"article":"737040071","brand_title":"Yato","title":"Набор инструментов 56 предметов YATO YT-14501","price":1200,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-yato-yt-14501-56-predmetov\/","category_string":"Наборы инструментов","article_for_display":"YT-14501","in_stock":true},{"id":1762,"article":"737159736","brand_title":"Yato","title":"Набор инструментов 225 предметов YATO YT-38941","price":7000,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-225-predmetov-yato-yt-38941\/","category_string":"Наборы инструментов","article_for_display":"YT-38941","in_stock":true},{"id":2284,"article":"737158375","brand_title":"Yato","title":"Набор инструмента для авто с ключами YATO YT-38881","price":4800,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-avto-s-kluchami-yato-yt-38881\/","category_string":"Наборы инструментов","article_for_display":"YT-38881","in_stock":true},{"id":2025,"article":"737217725","brand_title":"Yato","title":"Набор инструментов электрика профессиональный YATO YT-39009","price":3700,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-elektrika-professionalnyy-yato-yt-39009\/","category_string":"Наборы инструментов","article_for_display":"YT-39009","in_stock":true},{"id":2043,"article":"737488287","brand_title":"Yato","title":"Набор инструментов в ящике с выдвижными полками YATO YT-38951","price":4950,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-v-yashchike-s-vydvizhnymi-polkami-yato-yt-38951\/","category_string":"Наборы инструментов","article_for_display":"YT-38951","in_stock":true},{"id":2275,"article":"737061696","brand_title":"Yato","title":"Набор инструментов для ремонта автомобиля YATO YT-38741","price":2190,"url":"https:\/\/yato24.com.ua\/nabor-golovok-dlya-remonta-avtomobilya-yato-yt-38741\/","category_string":"Наборы инструментов","article_for_display":"YT-38741","in_stock":true},{"id":2276,"article":"737064521","brand_title":"Yato","title":"Набор инструментов с ключами YATO YT-38781","price":3500,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-s-kluchami-yato-yt-38781\/","category_string":"Наборы инструментов","article_for_display":"YT-38781","in_stock":true},{"id":2278,"article":"737148400","brand_title":"Yato","title":"Набор инструментов с ключами 82 эл. YATO YT-12691","price":3400,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-s-kluchami-dlya-remonta-avto-yato-yt-12691\/","category_string":"Наборы инструментов","article_for_display":"YT-12691","in_stock":true},{"id":2280,"article":"737156916","brand_title":"Yato","title":"Набор инструментов для автомобиля 111 предметов YATO YT-38831","price":4400,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-dlya-avtomobilya-yato-yt-38831\/","category_string":"Наборы инструментов","article_for_display":"YT-38831","in_stock":true},{"id":2283,"article":"737158259","brand_title":"Yato","title":"Набор инструмента для ремонта авто с насадками YATO YT-38872","price":5000,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-remonta-avto-s-nasadkami-yato-yt-38872\/","category_string":"Наборы инструментов","article_for_display":"YT-38872","in_stock":true},{"id":2285,"article":"737159448","brand_title":"Yato","title":"Набор инструмента для автомобиля с насадками YATO YT-38931","price":4200,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-avtomobilya-s-nasadkami-yato-yt-38931\/","category_string":"Наборы инструментов","article_for_display":"YT-38931","in_stock":true},{"id":2022,"article":"737174994","brand_title":"Yato","title":"Набор слесарно монтажного инструмента YATO YT-39280","price":1800,"url":"https:\/\/yato24.com.ua\/nabor-slesarno-montazhnogo-instrumenta-yato-yt-39280\/","category_string":"Наборы инструментов","article_for_display":"YT-39280","in_stock":true},{"id":2019,"article":"737158962","brand_title":"Yato","title":"Набор инструмента для ремонта автомобиля YATO YT-38811","price":5700,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-remonta-avtomobilya-yato-yt-38811\/","category_string":"Наборы инструментов","article_for_display":"YT-38811","in_stock":true},{"id":1761,"article":"737035923","brand_title":"Yato","title":"Набор инструментов YATO YT-14461","price":910,"url":"https:\/\/yato24.com.ua\/nabor-instrumentov-yato-yt-14461\/","category_string":"Наборы инструментов","article_for_display":"YT-14461","in_stock":true},{"id":1810,"article":"737525497","brand_title":"Yato","title":"Диагностический набор к форсункам common rail YATO YT-7306","price":1650,"url":"https:\/\/yato24.com.ua\/diagnosticheskiy-nabor-k-forsunkam-common-rail-yato-yt-7306\/","category_string":"Наборы инструментов","article_for_display":"YT-7306","in_stock":true},{"id":1811,"article":"737530482","brand_title":"Yato","title":"Набор инструмента для ремонта автомобильных генераторов YATO YT-04211","price":1860,"url":"https:\/\/yato24.com.ua\/nabor-instrumenta-dlya-remonta-avtomobilnykh-generatorov-yato-yt-04211\/","category_string":"Наборы инструментов","article_for_display":"YT-04211","in_stock":true}],
    ecProducts = [],
    ecProductsPerChunk = 5;
for (var i = 0, l = products.length; i < l; ++i) {
    var product = products[i];
    ecProducts.push({
        "id": product.article + "",
        "name": product.title + " (артикул: " + product.article_for_display + ")",
        "category": product.category_string,
        "brand": product.brand_title,
        "list": "Catalog Page",
        "position": i + 1
    });
}
while (ecProducts.length > 0) {
    var chunk = ecProducts.splice(0, ecProductsPerChunk);
    dataLayer.push({
        "event": "productImpression",
        "ecommerce": {
            "currencyCode": GLOBAL.currency.iso,
            "detail": {
                "products": chunk
            }
        }
    });
}
</script>"""
url = "https://yato24.com.ua/nabory-instrumentov/"
response = requests.get(url)
soup = BeautifulSoup(response.content, "html.parser")
scripts = soup.find("script", {"type": "text/javascript"})

script_tag = scripts.find('script', string=re.compile('var products ='))
# print(scripts)
# print(script_tag)
# Извлекаем содержимое тега script
pattern = r'var\s+products\s*=\s*(\[[^\]]*\])'

match = re.search(pattern, str(script_tag))
# print(match)
# urls = []
# if match:
#     products_str = match.group(1)
#     # print(products_str)
#     products_dict = json.loads(products_str)
#
#     urls = [item['url'] for item in products_dict]
# print(urls)
